项目需求说明书
一、项目概述

本项目旨在实现一个会员制的临时工雇佣系统，会员可以发布任务、承接任务，通过系统撮合完成交易，实现资金闭环。每个会员的净收益与支出、收入由系统控制，保证规则统一、闭环可控。

二、核心功能
1. 会员管理

会员类型：统一会员，无等级区分

注册：

会员注册需要缴纳一次性会员费 300 元（可通过充值功能）

默认角色为雇员

会员属性：

memberId：会员唯一标识

role：会员当前角色，雇员（employee）或雇主（employer）

totalExpense：累计支出

totalIncome：累计收入

balance：余额

会员方法：

recharge()：会员充值，固定金额 300 元

会员只保留状态，不直接处理任务逻辑

2. 任务管理（由系统服务统一管理）

单独创建 EmploymentService，负责所有任务逻辑，会员仅提供状态信息

任务类型：

每个任务由 两个雇主 和 一个雇员 组成

操作流程：

发布任务：

由雇主触发，雇主支付 300 元

角色变为雇主

承接任务：

由雇员触发，不增加余额，不影响支出

确认任务：

雇主确认任务完成后

雇员增加收入 600 元，余额增加 600 元

系统撮合交易：

方法 matchTask(employer1, employer2, employee)：

自动处理两个雇主发布任务，指定雇员承接并确认

记录支出和收益

输出交易日志

拍平逻辑：

如果会员数组中雇主不足或雇员不足，系统自动创建新会员，并充值 300 元

每次任务保证资金闭环规则：

净收益
=
总收入
−
总支出
≥
0
净收益=总收入−总支出≥0
3. 会员数组与任务循环

系统维护一个动态会员数组，初始为空

循环执行任务（可配置次数，如 10 次）

每次任务：

从数组中选择两个可做雇主的会员

如果不足两名雇主，则创建新会员

从数组中选择一个雇员（不能是已选的雇主）

如果不存在雇员，则创建新会员

执行 matchTask

任务完成后，会员状态和余额实时更新

4. 收益闭环规则

每个任务：

两个雇主各支付 300

一个雇员获得 600

承接任务不影响金额

发布任务立即扣款，确认任务发放收益

初始闭环启动：

系统可充当第一个任务的雇员，保证会员能完成第一次任务

闭环条件：

每个会员净收益 ≥ 0

每个任务至少涉及 3 个会员（2 雇主 + 1 雇员）

5. 系统日志与输出

每次任务撮合打印：

雇主 ID、雇员 ID

雇主支出、雇员收入

循环任务完成后：

输出每个会员总支出、总收入和余额

用于验证闭环及收益是否正确

6. 测试需求

使用 Jest 进行单元测试

测试内容：

会员充值功能

发布任务扣款

承接任务不影响余额

雇主确认任务雇员增加收入

系统撮合任务逻辑正确

循环任务后闭环收益正确，净收益 ≥ 0

7. 技术选型

语言：TypeScript / Node.js

测试框架：Jest

运行方式：

Node.js 直接执行 JS

或通过 ts-node 直接运行 TS

8. 扩展性

可配置任务次数、雇主支付、雇员收入金额

可增加会员等级、任务优先级、撮合策略

可导出任务日志和会员收益报表

如果你需要，我可以帮你画一个任务闭环流程图，从会员注册、充值、发布任务、承接任务到确认任务的完整流程，可视化资金流和角色变化。

你希望我画吗？